<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Latest Posts &#8211; Hardcore trial & error</title>
<meta name="description" content="hardcore trial & error">
<meta name="keywords" content="Jekyll, theme, themes, responsive, blog, modern">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/20110925-114605.jpg">

<meta name="twitter:title" content="Latest Posts">
<meta name="twitter:description" content="hardcore trial & error">
<meta name="twitter:creator" content="@jestersimpps">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Latest Posts">
<meta property="og:description" content="hardcore trial & error">
<meta property="og:url" content="/">
<meta property="og:site_name" content="Hardcore trial & error">





<link rel="canonical" href="/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Hardcore trial & error Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/bio-photo.png" alt="Jester Simpps photo" class="author-photo">
					<h4>Jester Simpps</h4>
					<p></p>
				</li>
				<li><a href="/about/"><span class="btn btn-inverse">Learn More</span></a></li>
				<li>
					<a href="mailto:jestersimpps@gmail.com"><i class="fa fa-fw fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/jestersimpps"><i class="fa fa-fw fa-twitter"></i> Twitter</a>
				</li>
				
				
				<li>
					<a href="http://linkedin.com/in/jo-vinkenroye/63/a79/459"><i class="fa fa-fw fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/jestersimpps"><i class="fa fa-fw fa-github"></i> GitHub</a>
				</li>
				
				<li>
					<a href="http://instagram.com/jestersimpps"><i class="fa fa-fw fa-instagram"></i> Instagram</a>
				</li>
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<div class="entry-header">
  <div class="image-credit">Image source: <a href="http://fogsmoviereviews.com">fogsmoviereviews.com</a></div><!-- /.image-credit -->
  
    <div class="entry-image">
      <img src="/images/20110925-114605.jpg" alt="Latest Posts">
    </div><!-- /.entry-image -->
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Hardcore trial & error</h1>
      <h2>Latest Posts</h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  
<article class="hentry">
  <header>
    
      <div class="entry-image-index">
        <a href="/setting-up-a-private-npm-registry-with-sinopia/" title="Setting Up a Private Npm Registry With Sinopia"><img src="/images/sinopia.png" alt="Setting Up a Private Npm Registry With Sinopia"></a>
      </div><!-- /.entry-image -->
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-12-05T06:24:06-05:00"><a href="/setting-up-a-private-npm-registry-with-sinopia/">December 05, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Jester Simpps">Jester Simpps</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~2 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/setting-up-a-private-npm-registry-with-sinopia/" rel="bookmark" title="Setting Up a Private Npm Registry With Sinopia" itemprop="url">Setting Up a Private Npm Registry With Sinopia</a></h1>
    
  </header>
  <div class="entry-content">
    <p>When you have several front end projects going in the same company, and you are using a component based framework like Angular 2, it is important that you can reuse those components over all projects. It is possible to pay npm for private repositories, or to make use of npm link, but in this post, I will:</p>

<ul>
  <li>Implement a private npm registry using <a href="https://github.com/rlidwka/sinopia">Sinopia</a>.</li>
  <li>Create a dummy Angular 2 module.</li>
  <li>Publish the module to my private npm registry</li>
  <li>Access the module from secondary application.</li>
</ul>

<h3 id="installing-sinopia">Installing Sinopia</h3>

<p>Do a global install of the package:</p>

<pre><code>npm install -g sinopia
</code></pre>

<p>Set your npm registry to your local Sinopia:</p>

<pre><code>npm set registry http://localhost:4873/
# if you wish to set it back to the default npmjs:
npm set registry https://registry.npmjs.org/
</code></pre>

<p>Run Sinopia using:</p>

<pre><code>sinopia
</code></pre>

<p>If everything works well, you should see that Sinopia automatically generated a config file and is now running at <code>http://localhost:4873/</code>.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">warn  --- config file  - /Users/jestersimpps/.config/sinopia/config.yaml
warn  --- http address - http://localhost:4873/</code></pre></figure>

<p>The Default configuration will allow all users to do anything. I’m going to leave this for now as I want to focus more on publishing and installing my own packages instead. If you are interested in setting up your own configuration file, you can find a full config file <a href="https://github.com/rlidwka/sinopia/blob/master/conf/full.yaml">here</a>.</p>

<h3 id="creating-a-packaged-angular-2-module">Creating a packaged Angular 2 module</h3>

<p>We will create an angular module from the ground up. Cd into the folder (<code>./dummy</code> in my case) you wish to use for your module and generate a <code>package.json</code> file by typing:</p>

<pre><code>mkdir dummy
cd dummy
npm init
</code></pre>

<p>This will ask you some questions about the library you wish to create, but don’t worry about those, you can just skip through them. Next, we have to include Angular 2 as a dependency, so we will do:</p>

<pre><code>npm i --save @angular/core
</code></pre>

<p>The <code>--save</code> command will add the installed dependency to the previously creatde <code>package.json</code> file.</p>

<p>Once Angular2 is installed, we will create a <code>.ts</code> source file at the root of our library with the name of our library:</p>

<pre><code>dummy.ts
</code></pre>
<p>This will be the name we will use later on when we will import our library from a secondary application:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span><span class="nx">dummy</span><span class="p">}</span> <span class="nx">from</span> <span class="s2">&quot;dummy/dummy&quot;</span><span class="p">;</span></code></pre></figure>

<p>This main file in the root will be used to export all of the files we will create next that make our module work.</p>

<p>to be continued…
<!-- https://github.com/rlidwka/sinopia
https://medium.com/@OCombe/how-to-publish-a-library-for-angular-2-on-npm-5f48cdabf435#.zed9c9ru3
https://blog.dylants.com/2014/05/10/creating-a-private-npm-registry-with-sinopia/
http://stackoverflow.com/questions/22385092/npm-config-set-registry-https-registry-npmjs-org-is-not-working-in-windows --></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
      <div class="entry-image-index">
        <a href="/a-cool-idea-for-scrolling-throough-posts/" title="A Post History Scroller"><img src="/images/historyscroll.jpg" alt="A Post History Scroller"></a>
      </div><!-- /.entry-image -->
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-11-09T18:05:30-05:00"><a href="/a-cool-idea-for-scrolling-throough-posts/">November 09, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Jester Simpps">Jester Simpps</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/a-cool-idea-for-scrolling-throough-posts/" rel="bookmark" title="A Post History Scroller" itemprop="url">A Post History Scroller</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Quite a few months ago I was working on a personal project called : <a href="http://mailwall.me">mailwall.me</a>.
The idea was a platform where you can share what you think someone will like using their mailwall.me address.
As most people in the world have email, but not necessary a fb,twitter,whatsapp,etc. account, people can email media to
people with a mailwall.me account.  The message would get parsed, media extracted and displayed in the proper way on the platform.
You could tie it up with <a href="http://www.ifttt.com">IFTTT</a> to mail you on social media events and it would automatically categorize everything
accordingly. This history posts scroller is an artifact of this project. I was looking for a new way to create a historical overview of the messages.</p>

<p><img src="https://github.com/jestersimpps/angular-history-scroll/raw/master/fYtRROmnmn.gif" alt="angular-history-scroller" /></p>

<p>The <a href="https://github.com/jestersimpps/angular-history-scroll">code</a> is a work in progress and haven’t tested it anymore.
I was going to make a generic version of it, but didn’t find the time.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
      <div class="entry-image-index">
        <a href="/getting-started-with-microservices-and-go/" title="Getting Started With Microservices and Go"><img src="/images/appenginegophercolor.jpg" alt="Getting Started With Microservices and Go"></a>
      </div><!-- /.entry-image -->
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-11-07T15:31:19-05:00"><a href="/getting-started-with-microservices-and-go/">November 07, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Jester Simpps">Jester Simpps</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~1 minute
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/getting-started-with-microservices-and-go/" rel="bookmark" title="Getting Started With Microservices and Go" itemprop="url">Getting Started With Microservices and Go</a></h1>
    
  </header>
  <div class="entry-content">
    <p>Traditionally applications have been built as monoliths; single applications which become larger and more complex over time, which limit our ability to react to change. Go is expressive, concise, clean, and efficient. Its concurrency mechanisms make it easy to write programs that get the most out of multicore and networked machines, while its novel type system enables flexible and modular program construction. Go compiles quickly to machine code yet has the convenience of garbage collection and the power of run-time reflection. It’s a fast, statically typed, compiled language that feels like a dynamically typed, interpreted language.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/dVnMLtdJzn4" frameborder="0" allowfullscreen=""></iframe>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
      <div class="entry-image-index">
        <a href="/from-gulp-to-webpack/" title="From Gulp to Webpack"><img src="/images/gg-vs-webpack.png" alt="From Gulp to Webpack"></a>
      </div><!-- /.entry-image -->
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-08-21T14:32:14-04:00"><a href="/from-gulp-to-webpack/">August 21, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Jester Simpps">Jester Simpps</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~7 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/from-gulp-to-webpack/" rel="bookmark" title="From Gulp to Webpack" itemprop="url">From Gulp to Webpack</a></h1>
    
  </header>
  <div class="entry-content">
    <p>I recently started working on a big Angular 2 webapp. The company I joined has been working on this project since Oktober 2015.
It is one of the first companies in Belgium that jumps on the ng2 bandwagon and it has been a joy and challenge to learn and work with this framework every day.</p>

<p>Because gulp experience was already in house, the team has implemented a gulp build coupled with SystemJs. These days ( August 2016 ),
partly popularized by React, <a href="https://webpack.github.io/">Webpack</a> has become a ‘thing’. My colleagues at the company have been following the trend and have decided to switch to <a href="https://webpack.github.io/">Webpack</a> for their next project.
Secretly, there’s a common desire to implement it in the current project as well, but… there is this tight deadline, so…</p>

<p>…I decided to give it a shot myself and tried to hack something together this Saturday and see how far I would get. To be honest, I didn’t know what to expect myself.
I’ve heard all the buzz but haven’t actually given Webpack any time as I have been working relentlessly on my own startup <a href="http://www.krackzee.com/search?sortby=distance&amp;order=&amp;radius=50&amp;classes=11th%20Commerce&amp;locality=Sector%2025&amp;city=Pune#">krackzee</a> over the past 8 months, which is a php Laravel project. So I have been ‘out’ of the front-end world for quite some time. To all non-javascript developers; 8 months in the javascript realm is like a decade in your language. (
<a href="https://www.allenpike.com/2015/javascript-framework-fatigue/"> Read: A JS framework on every table by Allen Pike </a>)</p>

<p><img src="https://www.allenpike.com/images/2015/cube-drone-angular.jpg" alt="javascript fatigue" /></p>

<h2 id="webpack">Webpack</h2>

<h3 id="first-impressions">First impressions</h3>

<p>The installation has a lot of simalarity to installing grunt or gulp. You pull in some repositories, make sure you save them as devDependencies in your package.json and create some config files to configure your build process. Here’s the interesting part though; It’s almost like a plug and play build process tool. Forget about writing those <a href="http://jestersimpps.github.io/experimenting-with-google-spreadsheets-assemble-io-and-internationalisation/">insane</a>, customized grunt and gulp scripts. Here’s a tool that just works out of the box with minimal configuration. And it works well!</p>

<h3 id="getting-started">Getting started</h3>

<p>The <a href="https://angular.io/docs/ts/latest/guide/webpack.html">Angular 2</a> team has done a pretty good job explaining Webpack on their website. It has also become their build tool of choice. I started by basically going through their guide and adapting their implementation in a seperate branch to our current project. Don’t do this! I made this mistake and I might have learned a bit more about what the Webpack config files do, but it will fail miserably unless you have implemented webpack before and you know how everything works together. My suggestion is to start a different repo alltogether with a clean version of one of the <a href="https://github.com/search?utf8=%E2%9C%93&amp;q=angular+2+webpack+starter&amp;type=Repositories&amp;ref=searchresults">Angular 2 webpack starters</a> out there. Just browse <a href="http://github.com">Github</a> a bit, there’s plenty of them.</p>

<p>I chose for the <a href="https://github.com/AngularClass/angular2-webpack-starter">angular2-webpack-starter</a> from <a href="https://angularclass.com/">AngularClass</a></p>

<h3 id="clone-your-favorite-starter">Clone your favorite starter</h3>

<p>Start by cloning your favorite Webpack starter repo somewhere on your hard drive.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">git clone https://github.com/AngularClass/angular2-webpack-starter.git
<span class="nb">cd </span>angular2-webpack-starter
npm i</code></pre></figure>

<p>If you choose to use the same starter as me, make sure you have Node version &gt;= 5.0 and NPM &gt;= 3 as mentioned in their readme.</p>

<h3 id="move-your-code">Move your code</h3>

<p>After having a local version of the starter, I removed all of their awesomely, perfected, genius code from the <code>src/app</code> folder and copied in our own.
Remove the git directory if you haven’t yet, and set up your own repo. Maybe make a first commit and push.
From this moment onward there’s a lot of nitty gritty changes to the Webpack configuration, but basically you are almost done!</p>

<h3 id="reconfigure-webpack">Reconfigure Webpack</h3>

<h4 id="folders-and-files">Folders and files</h4>

<p>Depending on how you have set up your Angular 2 application you will have a different <code>main.ts</code> file.(assuming you are coding Typescript, I’ll just ignore anyone who isn’t)
The <code>main.ts</code> file is that file that holds your main app component (everything starts from there, your JS app big bang). Webpack best practice commands you to split it up into 3 files:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">entry</span><span class="o">:</span> <span class="p">{</span>

  <span class="s1">&#39;polyfills&#39;</span><span class="o">:</span> <span class="s1">&#39;./src/polyfills.browser.ts&#39;</span><span class="p">,</span>
  <span class="s1">&#39;vendor&#39;</span><span class="o">:</span> <span class="s1">&#39;./src/vendor.browser.ts&#39;</span><span class="p">,</span>
  <span class="s1">&#39;main&#39;</span><span class="o">:</span> <span class="s1">&#39;./src/main.browser.ts&#39;</span>

<span class="p">},</span></code></pre></figure>

<p>It’s pretty obvious but, define your polyfill imports in the <code>src/polyfills.browser.ts</code> file, your vendor modules in the <code>src/vendor.browser.ts</code> file and bootstrap your app in the <code>src/main.browser.ts</code> file. I just left the polyfill file alone because it was mostly the same of what we already had. Then, in the <code>config/webpack.common.js</code> file, set your entry points as depicted above. In the platform folder, define your environment &amp; provider settings if you have them.</p>

<p>Remove all script tags in your <code>index.html</code> file that point to any application code. These will get injected by a Webpack plugin called <a href="https://github.com/ampedandwired/html-webpack-plugin">HtmlWebpackPlugin</a>. Compare the index files of the starter with your own and basically resolve any merge conflicts :)</p>

<p>Set your own constants in the <code>config/webpack.common.js</code>:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">METADATA</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Yourapp&#39;</span><span class="p">,</span>
  <span class="nx">baseUrl</span><span class="o">:</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span>
  <span class="nx">isDevServer</span><span class="o">:</span> <span class="nx">helpers</span><span class="p">.</span><span class="nx">isWebpackDevServer</span><span class="p">()</span>
<span class="p">};</span></code></pre></figure>

<p>If you work at a special company and have a designated designer that takes care of the scss for you, there’s a chance you might have to set up some build configuration using the <a href="http://webpack.github.io/docs/stylesheets.html#separate-css-bundle">ExtractTextPlugin</a> that enables you to use an import to define the to-be-converted scss files. (I will not cover this as we are currently moving our styling into a separate repo)</p>

<h4 id="environment-config">Environment config</h4>

<p>Depending on your environment configuration you will have to make changes to the <code>config/webpack.dev.js</code>,<code>config/webpack.prod.js</code>,<code>config/webpack.test.js</code> files.
We previously set the environment in a json during the gulp build. In the new Webpack configuration, I am using a constant I set in the ‘DefinePlugin’ that is then used in my code to determine the Api endpoint and such.</p>

<h4 id="testing-config">Testing config</h4>

<p>If you were already using Karma and Jasmine, just compare the starter’s <code>config/karma.conf.js</code> file with your own. Make changes to the already existing file - if any.
Make sure you have a <code>karma.conf.js</code> pointing to the file in the config folder.</p>

<h4 id="troubleshooting">Troubleshooting</h4>

<p>After all this, cross your fingers and run the Webpack dev server using <code>npm start</code>.
In my case there were issues because we are using html template files for our components and have referenced them to our app root directory.</p>

<p>Refer the HTML template files in relation to the current typescript file:</p>

<pre><code>@Component({
    selector: `component1`,
    templateUrl: './component1.component.tmpl.html'
})
</code></pre>
<p>instead of:</p>

<pre><code>@Component({
    selector: `component1`,
    templateUrl: 'app/../blablablabla/../component1.component.tmpl.html'
})
</code></pre>

<h3 id="conclusion">Conclusion</h3>

<h4 id="in-memory-live-reloading">In memory live reloading</h4>

<p>Make the move asap, it won’t take too much of your time! Especially if your grunt/gulp build process is currently not sporting any in memory live reloading. The time you save with this feature alone easily makes up for the time invested in figuring out implementing Webpack.</p>

<h4 id="lazy-loading-modules">Lazy loading modules</h4>

<p>Also, Webpack will pack your modules so that they will be lazy loaded (async) in your application. Often you don’t need all of the dependencies at runtime. Lazy loading will boost your application significantly. Read more about it <a href="http://survivejs.com/webpack/advanced-techniques/understanding-chunks/#lazy-loading-with-webpack">here</a>.</p>

<p>Anyways, you won’t be disappointed. Webpack is magic ;)</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->

<article class="hentry">
  <header>
    
      <div class="entry-image-index">
        <a href="/automated-e2e-api-testing-documentation-for-node-js/" title="Automated E2e API Testing/Documentation for Node.js"><img src="/images/mocha.jpg" alt="Automated E2e API Testing/Documentation for Node.js"></a>
      </div><!-- /.entry-image -->
    
    <div class="entry-meta">
      <span class="entry-date date published updated"><time datetime="2016-07-22T06:46:58-04:00"><a href="/automated-e2e-api-testing-documentation-for-node-js/">July 22, 2016</a></time></span><span class="author vcard"><span class="fn"><a href="/about/" title="About Jester Simpps">Jester Simpps</a></span></span>
      
      <span class="entry-reading-time">
        <i class="fa fa-clock-o"></i>
        
        Reading time ~10 minutes
      </span><!-- /.entry-reading-time -->
      
    </div><!-- /.entry-meta -->
    
      <h1 class="entry-title"><a href="/automated-e2e-api-testing-documentation-for-node-js/" rel="bookmark" title="Automated E2e API Testing/Documentation for Node.js" itemprop="url">Automated E2e API Testing/Documentation for Node.js</a></h1>
    
  </header>
  <div class="entry-content">
    <p>This was my first time doing test driven API development in Node.js and I must say, I really enjoyed it. I used to fall back on a Chrome plugin called <a href="https://www.getpostman.com/">Postman</a> a lot before getting used to Mocha and test driven development. It was a joy to write code for a test that described what the endpoint should do before actually coding the new endpoint. It made me think more about the code I was going to write and what it should do. It also happened sometimes that there would be a total API overhaul (like the implementation of softdeletes). And, man was I glad I had written unit tests for all my endpoints when that happened!</p>

<h2 id="butwait-wont-i-lose-a-lot-of-time-doing-that">But…wait.. won’t I lose a lot of time doing that?!?</h2>

<p><img src="https://risingstack-blog.s3-eu-west-1.amazonaws.com/2014/Oct/unit_testing.jpeg" alt="unit tests" /></p>

<p>Writing API tests for a node.js API can be a tedious job. We are dealing with a single event loop, so we need to take in account callbacks. Especially when doing API testing, callbacks can quickly become a pain point. A lot of times, checking whether requests work means triggering other requests sequentially to see if the database was updated by previous requests. This is why, after refactoring a bit of my tests, I was able to create a simple end-to-end testscript that I would just call whenever I wrote a new route. Every time with different input data specific to the route of course. I was later able to tie in APIDoc, a documentation generator that will create a frontend containing the documentation for all your endpoints. So in the end all my endpoints were not only fully tested, but also automatically documented in one go. This was very nice and saved me a lot of time.</p>

<h2 id="dependencies">Dependencies</h2>

<h3 id="testing">Testing</h3>

<ul>
  <li>We will be using <a href="https://mochajs.org/">Mocha</a> as a testing framework for our Node.js API.</li>
  <li>Mocha is great, but not perfect, so on top of it, we will include the <a href="https://github.com/visionmedia/supertest">supertest</a> package that will provide abstraction for HTTP testing.</li>
  <li>As I refactored my end to end tests into one single testscript, we will also need a package called <a href="https://www.npmjs.com/package/partial-compare">partial compare</a> that will do partial matching between test objects and actual return-objects from the api.</li>
  <li>We will also use <a href="https://www.npmjs.com/package/should">should</a> to make our testing code more human readable and easier to write.</li>
</ul>

<h3 id="api-documentation">API documentation</h3>

<ul>
  <li>A great library called <a href="http://apidocjs.com/">APIdoc</a> will take care of documenting all of the endpoints</li>
  <li>A plugin of that library <a href="https://www.npmjs.com/package/apidoc-plugin-schema">apidoc-plugin-schema</a> will make our life easier.</li>
</ul>

<p>In the package.json file:</p>

<pre><code>"devDependencies": {
  "apidoc-plugin-schema": "0.0.4",
  "body-parser": "~1.8.1",
  "fs": "0.0.2",
  "jsonfile": "^2.3.1",
  "mocha": "^2.1.0",
  "partial-compare": "^1.0.1",
  "path": "^0.12.7",
  "should": "~4.6.2",
  "supertest": "^0.15.0",
  "type-of-is": "^3.4.0"
}
</code></pre>

<h2 id="end-to-end-testing">End to end testing</h2>

<p>Wikipedia says:</p>

<blockquote>
  <p>End-to-end testing is a technique used to test whether the flow of an application right from start to finish is behaving as expected. The purpose of performing end-to-end testing is to identify system dependencies and to ensure that the data integrity is maintained between various system components and systems.</p>
</blockquote>

<p>Translate this to API testing and you get:</p>

<ol>
  <li>GET an array of existing data</li>
  <li>POST some new data</li>
  <li>Test if the new data was posted</li>
  <li>Change the new data using PUT</li>
  <li>Test if the new data was changed</li>
  <li>DELETE the new data</li>
  <li>Test if the new data was removed</li>
</ol>

<p>Of course this is the most simple scenario of RESTful API testing, and I know there’s some other endpoints that can be more complex (like counters, searches, etc.) But I will not elaborate on these in this post as these most of the time imply writing custom tests.</p>

<h2 id="a-test-script-that-covers-multiple-endpoints">A test script that covers multiple endpoints</h2>

<p>Because the sequence of testing is the same for all endpoints, I created a general script that will test different endpoints using the same code but different input based on the endpoint’s data. The input data will be stored in an object that will be called from an endpoint file in the ‘test/routes’ folder.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">├── <span class="nb">test</span>
<span class="p">|</span>    ├── routes  
<span class="p">|</span>         ├── endpoint1.js
<span class="p">|</span>         ├── endpoint2.js
<span class="p">|</span>         ├── endpoint3.js
<span class="p">|</span>    ├── e2e_tests.js
<span class="p">|</span>    ├── schema_generator.js
<span class="p">|</span>              </code></pre></figure>

<p>The content of the endpoint file will contain the e2e_test options object which has some options for the endpoint tests and apidoc generator.
Next to the options, a testData object contains all data needed to perform the tests. The object attributes are pretty self explanatory:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">//define the e2e script</span>
<span class="kr">const</span> <span class="nx">e2e</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./e2e_tests.js&#39;</span><span class="p">);</span>
<span class="c1">// this should refer to the express app you have set up for your api</span>
<span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>

<span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>

	<span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">//timeout between requests</span>
		<span class="nx">timeout</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="c1">//your express app</span>
		<span class="nx">api</span><span class="o">:</span> <span class="nx">app</span><span class="p">,</span>
    <span class="c1">//generate apidoc or not?</span>
		<span class="nx">apidoc</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="c1">//where do you want to store the schema jsons for the apidoc schema plugin?</span>
		<span class="nx">schemaDir</span><span class="o">:</span> <span class="nx">__dirname</span> <span class="o">+</span> <span class="err">`</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="nx">data</span><span class="o">/</span><span class="nx">apischemas</span><span class="o">/</span><span class="err">`</span>
	<span class="p">}</span>


	<span class="kd">let</span> <span class="nx">testData</span> <span class="o">=</span> <span class="p">{</span>
		<span class="nx">routeName</span><span class="o">:</span> <span class="s1">&#39;Articles&#39;</span><span class="p">,</span>
		<span class="nx">postObject</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;this is an article&#39;</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="nx">expectedObjectAfterPost</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;this is an article&#39;</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="nx">putObject</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;this is an article too&#39;</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="nx">expectedObjectAfterPut</span><span class="o">:</span> <span class="p">{</span>
			<span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;this is an article too&#39;</span><span class="p">,</span>
		<span class="p">}</span>
	<span class="p">};</span>

  <span class="c1">//You can then call a unit test for this endpoint by calling the script:</span>
	<span class="nx">e2e</span><span class="p">(</span><span class="nx">testData</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>


<span class="p">})();</span></code></pre></figure>

<p>When we run mocha the end-to-end script will be called and run all tests for that endpoint. If you have specified a schemaDir and the apidoc boolean is set to true, the script will also automatically generate json schemas for the apidoc based on the testData.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">node_modules/.bin/mocha</code></pre></figure>

<p>Console output for a working API should be similar to:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">-------- Albums tests --------

GET /Albums <span class="m">200</span> 148.080 ms - 2
Counting Albums: 0
    ✓ Should <span class="k">return</span> an array of Albums
--POST shows/: <span class="o">{</span><span class="s2">&quot;general&quot;</span>:<span class="o">{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;Ascot&quot;</span><span class="o">}</span>,<span class="s2">&quot;time&quot;</span>:<span class="o">{</span><span class="s2">&quot;startDate&quot;</span>:<span class="s2">&quot;2016-04-06T21:51:15.000Z&quot;</span><span class="o">}</span>,<span class="s2">&quot;type&quot;</span>:<span class="s2">&quot;album&quot;</span><span class="o">}</span>
POST /Albums <span class="m">200</span> 151.935 ms - 1996
Adding: <span class="m">1</span> Album
    ✓ Should create a new Album
GET /Albums/5789159e34150fe84c463f28 <span class="m">200</span> 117.938 ms - 1996
    ✓ Should get the new Album
GET /Albums <span class="m">200</span> 103.512 ms - 1998
Counting Albums: 1, should be: 1
    ✓ Should <span class="k">return</span> an array of Albums with the correct size
PUT /Albums/5789159e34150fe84c463f28 <span class="m">200</span> 115.422 ms - 1997
    ✓ Should change a Album
GET /Albums/5789159e34150fe84c463f28 <span class="m">200</span> 102.205 ms - 1997
    ✓ Should get the changed Album
DELETE /Albums/5789159e34150fe84c463f28 <span class="m">200</span> 116.241 ms - 2018
Removing: <span class="m">1</span> Album
    ✓ Should remove a Album
GET /Albums <span class="m">200</span> 104.573 ms - 2
Counting Albums: 0, should be: 0
    ✓ Should get an array without the deleted Album

-------- Articles tests --------

GET /Articles <span class="m">200</span> 92.230 ms - 2
Counting Articles: 0
    ✓ Should <span class="k">return</span> an array of Articles
POST /Articles <span class="m">200</span> 98.047 ms - 300
Adding: <span class="m">1</span> Article
    ✓ Should create a new Article
GET /Articles/578915a134150fe84c463f39 <span class="m">200</span> 99.768 ms - 300
    ✓ Should get the new Article
GET /Articles <span class="m">200</span> 107.985 ms - 302
Counting Articles: 1, should be: 1
    ✓ Should <span class="k">return</span> an array of Articles with the correct size
DELETE /Articles/578915a134150fe84c463f39 <span class="m">200</span> 99.193 ms - 329
Removing: <span class="m">1</span> Article
    ✓ Should remove a Article
GET /Articles <span class="m">200</span> 101.275 ms - 304
Counting Articles: 0, should be: 0
    ✓ Should get an array without the deleted Article


  <span class="m">2</span> passing <span class="o">(</span>4s<span class="o">)</span>

info: Done.</code></pre></figure>

<h2 id="api-documentation-generator">API documentation generator</h2>

<p>In your route files, above your endpoints, you can then add the following comment blocks:</p>

<ul>
  <li><a href="https://github.com/jestersimpps/node_rest_test_doc/blob/master/test/routes/APIDOC.md">api doc helpers</a></li>
</ul>

<p>Change them according to your endpoints of course. They will be used by the APIdoc generator to create the documentation frontend.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="cm">/**</span>
<span class="cm">* @apiSchema {jsonschema=../test/data/apischemas/&lt;routecaps&gt;-POST-create-a-new-&lt;routesingle&gt;-PARAMS.json} apiParam</span>
<span class="cm">* @apiSchema {jsonschema=../test/data/apischemas/&lt;routecaps&gt;-POST-create-a-new-&lt;routesingle&gt;-SUCCESS.json} apiSuccess</span>
<span class="cm">*/</span></code></pre></figure>

<p>The apiSchema references in the comments displayed above will point at the schema jsons that are generated by the <a href="https://github.com/jestersimpps/node_rest_test_doc/blob/master/test/schema_generator.js">schema_generator</a>.
The output directory can be changed in the options object in the endpoint test file as illustrated earlier.</p>

<p>Assuming the <code>./routes</code> folder contains your api’s route files and the <code>./public</code> folder is the folder that will contain the apidoc frontend, generate your api documentation by running:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">apidoc -i ./routes -o ./public/</code></pre></figure>

<ul>
  <li>These tests were run using mongoDB, which uses <code>_id</code> as a primary key. You might have to edit the test script to your needs a bit when you are using a different database or key/slug to perform individual GET,PUT,DELETE requests.</li>
  <li>In the e2e_test script, basic authentication was used. You might also need to change this according to the authentication methods of your API.</li>
</ul>

<p>The entire code and scripts can be found <a href="https://github.com/jestersimpps/node_rest_test_doc">here</a></p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->


<div class="pagination">
  
    Previous
  
  <ul class="inline-list">
    <li>
      
        <span class="current-page">1</span>
      
    </li>
    
      <li>
        
          <a href="/page2">2</a>
        
      </li>
    
      <li>
        
          <a href="/page3">3</a>
        
      </li>
    
  </ul>
  
    <a href="/page2" class="btn">Next</a>
  
</div><!-- /.pagination -->

</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2016 Jester Simpps. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67531656-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>


          

</body>
</html>